"use strict";(globalThis["webpackChunktesis_scout_front"]=globalThis["webpackChunktesis_scout_front"]||[]).push([[480],{2480:(e,l,a)=>{a.r(l),a.d(l,{default:()=>M});var o=a(3673),t=a(8880),i=a(1959),n=a(2323),s=a(386),u=a(78),m=a(9582),d=a(2862),r=a(8825),c=a(4940),p=a(228);const g={class:"q-pa-md"},w=["src"],f=(0,o._)("div",{class:"text-h6"},"Alerta",-1),_=(0,o.Uk)(" Â¿Desea eliminar el grupo seleccionado? "),v=(0,o.Uk)("Nuevo Unidad"),h=(0,o.Uk)("Close"),y={class:"col-md-5 col-sm-12"},W=(0,o.Uk)("Agregar Equipo"),b={class:"col-md-4 col-sm-12"},q=(0,o._)("div",{class:"text-h6"},"Dirigentes de la Unidad",-1),k=(0,o.Uk)(" No hay dirigentes en esta unidad "),Z={__name:"Unit",setup(e){const l=(0,r.Z)(),a=(0,d.U)(),Z=((0,m.tv)(),(0,i.iH)(!1)),U=(0,i.iH)(!1),V=[{name:"img",label:"Logo"},{namel:"name",required:!0,label:"Nombre",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0},{name:"group",align:"center",label:"Grupo",field:({group:e})=>e.name},{name:"actions",label:"Acciones",align:"center"}],x=(0,i.iH)([]),C=(0,i.iH)([]),Q=(0,i.iH)(!1),I=(0,i.iH)(!1),H=(0,i.iH)(""),A=(0,i.iH)([]),D=(0,i.iH)([]),F=(0,i.qj)({id:"",name:"",groupId:"",img_url:"",type:"",teams:[]}),S=e=>{Z.value=!0,F.id=e.id},T=()=>{u.Z["delete"](F.id).then((e=>{1==e.success?(l.notify({type:"success",message:e.message,timeout:2e3}),console.log(e),B()):l.notify({type:"negative",message:e.message,timeout:2e3})}))},j=e=>{I.value=!1,Q.value=!0,console.log(e),F.name=e.name,F.img_url=e.image;let l=C.value.find((l=>l.id==e.group_id));F.groupId=l.id,F.type=e.type,F.id=e.id},z=async()=>{const e=await u.Z.create({name:F.name,group_id:F.groupId,equipos:F.teams,image:F.img_url});Q.value=!1,console.log(e),B()},N=async()=>{const e=await s.Z.getGroups();if(C.value=e,4==a.role){const e=await p.Z.getProfileDirecting();F.groupId=e.profile.group_id,console.log(F),console.log(e)}},B=async()=>{let e;l.loading.show(),e=1==a.role?await u.Z.getUnits():await u.Z.getUnitsDirecting(),l.loading.hide(),x.value=e},K=e=>new Promise(((e,l)=>{const a=localStorage.getItem("token");e({url:"http://127.0.0.1:8000/api/fileUnit",method:"POST",headers:[{name:"Authorization",value:`Bearer ${a}`}]})})),G=(e,l)=>{const a=l.map((e=>e.id)).indexOf(e.id);-1!=a&&l.splice(a,1)},P=e=>{F.img_url=e.xhr.response,console.log(e.xhr.response)},L=()=>{const e=(0,i.qj)({name:""});F.teams.push(e)},O=()=>{Q.value=!0,I.value=!0,F.name="",F.type="",F.img_url="",F.teams=[],4!=a.role&&(F.groupId="")},Y=()=>{const e={name:F.name,group_id:F.groupId,type:F.type,image:F.img_url,id:F.id};u.Z.update(e).then((e=>{O(),Q.value=!1,B(),console.log(e)}))},E=e=>{u.Z.activate(e.id).then((e=>{1==e.success&&B()}))},J=async e=>{console.log(e),U.value=!0;const l=await p.Z.getDirectingsByUnit(e.id);A.value=l.directings,console.log(l)},$=async()=>{const e=await c.Z.showAll();D.value=e.ranges,console.log(e)};return(0,o.wF)((()=>{$(),N(),B()})),(e,l)=>{const s=(0,o.up)("q-btn"),u=(0,o.up)("q-icon"),m=(0,o.up)("q-input"),d=(0,o.up)("q-td"),r=(0,o.up)("q-avatar"),c=(0,o.up)("q-table"),p=(0,o.up)("q-card-section"),N=(0,o.up)("q-card-actions"),B=(0,o.up)("q-card"),$=(0,o.up)("q-dialog"),M=(0,o.up)("q-toolbar-title"),R=(0,o.up)("q-space"),X=(0,o.up)("q-tooltip"),ee=(0,o.up)("q-bar"),le=(0,o.up)("q-select"),ae=(0,o.up)("q-uploader"),oe=(0,o.up)("q-img"),te=(0,o.up)("q-form"),ie=(0,o.up)("q-item-section"),ne=(0,o.up)("q-item"),se=(0,o.up)("q-list"),ue=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",g,[(0,o.Wm)(s,{label:"Agregar",color:"primary",class:"q-ma-md",onClick:O}),(0,o.Wm)(c,{title:"Unidades Scouts",rows:x.value,columns:V,"row-key":"name",filter:H.value},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(m,{borderless:"",dense:"",debounce:"300",modelValue:H.value,"onUpdate:modelValue":l[0]||(l[0]=e=>H.value=e),placeholder:"Buscar..."},{append:(0,o.w5)((()=>[(0,o.Wm)(u,{name:"search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,o.w5)((e=>[(0,o.Wm)(d,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{color:"blue",icon:"info",onClick:l=>J(e.row)},null,8,["onClick"]),(0,o.Wm)(s,{color:"yellow",icon:"mode_edit",class:"q-mx-sm",onClick:l=>j(e.row)},null,8,["onClick"]),(0,o.wy)((0,o.Wm)(s,{color:"red",icon:"delete",onClick:l=>S(e.row)},null,8,["onClick"]),[[t.F8,"A"==e.row.state]]),(0,o.wy)((0,o.Wm)(s,{color:"green",icon:"add",onClick:l=>E(e.row)},null,8,["onClick"]),[[t.F8,"A"!=e.row.state]])])),_:2},1032,["props"])])),"body-cell-img":(0,o.w5)((e=>[(0,o.Wm)(d,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{rounded:""},{default:(0,o.w5)((()=>[(0,o._)("img",{src:null==e.row.image?"https://i.imgur.com/wKV0Jmy.png":e.row.image,alt:"No Tiene Imagen",size:"100px"},null,8,w)])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["rows","filter"])]),(0,o.Wm)($,{modelValue:Z.value,"onUpdate:modelValue":l[1]||(l[1]=e=>Z.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{style:{width:"300px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[f])),_:1}),(0,o.Wm)(p,{class:"q-pt-none"},{default:(0,o.w5)((()=>[_])),_:1}),(0,o.Wm)(N,{align:"right",class:"bg-white text-teal"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(s,{flat:"",label:"Si",color:"red",onClick:T},null,512),[[ue]]),(0,o.wy)((0,o.Wm)(s,{flat:"",label:"No"},null,512),[[ue]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)($,{modelValue:Q.value,"onUpdate:modelValue":l[5]||(l[5]=e=>Q.value=e),"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{style:{width:"900px","max-width":"80vw"}},{default:(0,o.w5)((()=>[(0,o.Wm)(ee,null,{default:(0,o.w5)((()=>[(0,o.Wm)(M,null,{default:(0,o.w5)((()=>[v])),_:1}),(0,o.Wm)(R),(0,o.wy)(((0,o.wg)(),(0,o.j4)(s,{dense:"",flat:"",icon:"close"},{default:(0,o.w5)((()=>[(0,o.Wm)(X,{class:"bg-white text-primary"},{default:(0,o.w5)((()=>[h])),_:1})])),_:1})),[[ue]])])),_:1}),(0,o.Wm)(p,{class:"col q-pt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(te,{class:"q-gutter-md row q-pa-sm justify-center"},{default:(0,o.w5)((()=>[(0,o._)("div",y,[(0,o.Wm)(m,{class:"col-12",filled:"",modelValue:F.name,"onUpdate:modelValue":l[2]||(l[2]=e=>F.name=e),label:"Nombre"},null,8,["modelValue"]),(0,o.Wm)(le,{class:"col-12 q-mt-sm",filled:"","emit-value":"","map-options":"",modelValue:F.groupId,"onUpdate:modelValue":l[3]||(l[3]=e=>F.groupId=e),disable:4==(0,i.SU)(a).role,options:C.value,"option-value":"id","option-label":"name",label:"Selecciona un Grupo"},null,8,["modelValue","disable","options"]),(0,o.Wm)(le,{filled:"",class:"q-mt-sm","option-value":"name",modelValue:F.type,"onUpdate:modelValue":l[4]||(l[4]=e=>F.type=e),options:D.value,"emit-value":"","map-options":"","option-label":"name"},null,8,["modelValue","options"]),(0,o.Wm)(ae,{class:"q-mt-sm","max-files":1,onFinish:e.fileUpload,onUploaded:P,factory:K,style:{"max-width":"300px"},"field-name":"image",color:"amber",label:"Logo"},null,8,["onFinish"]),(0,o.wy)((0,o.Wm)(s,{class:"q-mt-sm",onClick:L},{default:(0,o.w5)((()=>[W])),_:1},512),[[t.F8,I.value]])]),(0,o.wy)((0,o._)("div",b,[(0,o.Wm)(oe,{src:""==F.img_url?"https://i.imgur.com/wKV0Jmy.png":F.img_url,"spinner-color":"white",style:{height:"140px","max-width":"150px",border:"yellow 5px solid"}},null,8,["src"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(F.teams,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"row"},[(0,o.Wm)(m,{class:"col-12",filled:"",modelValue:e.name,"onUpdate:modelValue":l=>e.name=l,label:"Equipo"},{append:(0,o.w5)((()=>[(0,o.Wm)(u,{name:"close",class:"cursor-pointer",onClick:l=>G(e,F.teams)},null,8,["onClick"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])))),128))],512),[[t.F8,I.value]])])),_:1})])),_:1}),(0,o.Wm)(N,{align:"right",class:"bg-white text-teal"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(s,{flat:"",label:"Guardar",onClick:z},null,512),[[t.F8,I.value]]),(0,o.wy)((0,o.Wm)(s,{flat:"",label:"Actualizar",onClick:Y},null,512),[[t.F8,!I.value]])])),_:1}),(0,o.Uk)(" "+(0,n.zw)(e.scout),1)])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)($,{modelValue:U.value,"onUpdate:modelValue":l[6]||(l[6]=e=>U.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{style:{width:"700px","max-width":"80vw"}},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[q])),_:1}),(0,o.Wm)(p,{class:"q-pt-none"},{default:(0,o.w5)((()=>[A.value.length>0?((0,o.wg)(),(0,o.j4)(se,{key:0,bordered:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(A.value,(e=>((0,o.wg)(),(0,o.j4)(ne,{clickable:"",key:e.id},{default:(0,o.w5)((()=>[(0,o.Wm)(ie,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(oe,{src:""==e.person.image||null==e.person.image?"https://png.pngtree.com/png-vector/20190116/ourlarge/pngtree-vector-avatar-icon-png-image_322275.jpg":e.profile.image},null,8,["src"])])),_:2},1024)])),_:2},1024),(0,o.Wm)(ie,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.person.name)+" "+(0,n.zw)(e.person.last_name),1)])),_:2},1024),(0,o.Wm)(ie,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.person.user.roles[0].nombre),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):((0,o.wg)(),(0,o.j4)(se,{key:1,bordered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(ie,null,{default:(0,o.w5)((()=>[k])),_:1})])),_:1}))])),_:1}),(0,o.Wm)(N,{align:"right",class:"bg-white text-teal"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(s,{flat:"",label:"OK"},null,512),[[ue]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var U=a(8240),V=a(3243),x=a(4842),C=a(4554),Q=a(3884),I=a(5096),H=a(6778),A=a(151),D=a(5589),F=a(9367),S=a(846),T=a(3747),j=a(2025),z=a(8870),N=a(5269),B=a(8516),K=a(3768),G=a(4027),P=a(7011),L=a(3414),O=a(2035),Y=a(677),E=a(7518),J=a.n(E);const $=Z,M=$;J()(Z,"components",{QBtn:U.Z,QTable:V.Z,QInput:x.Z,QIcon:C.Z,QTd:Q.Z,QAvatar:I.Z,QDialog:H.Z,QCard:A.Z,QCardSection:D.Z,QCardActions:F.Z,QBar:S.Z,QToolbarTitle:T.Z,QSpace:j.Z,QTooltip:z.Z,QForm:N.Z,QSelect:B.Z,QUploader:K.Z,QImg:G.Z,QList:P.Z,QItem:L.Z,QItemSection:O.Z}),J()(Z,"directives",{ClosePopup:Y.Z})}}]);