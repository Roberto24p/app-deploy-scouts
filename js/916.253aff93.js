"use strict";(globalThis["webpackChunktesis_scout_front"]=globalThis["webpackChunktesis_scout_front"]||[]).push([[916],{3916:(e,l,a)=>{a.r(l),a.d(l,{default:()=>$});var o=a(3673),n=a(8880),t=a(1959);const s={all:async()=>{const e=localStorage.getItem("token"),l=await fetch("http://157.245.142.215/api-scouts/public/api/user",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),a=await l.json();return a},create:async e=>{const l=localStorage.getItem("token"),a=await fetch("http://157.245.142.215/api-scouts/public/api/user",{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(e),method:"POST"}),o=await a.json();return o},update:async e=>{const l=localStorage.getItem("token"),a=await fetch(`http://157.245.142.215/api-scouts/public/api/user/${e.id}`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(e),method:"PUT"}),o=await a.json();return o},delete:async e=>{const l=localStorage.getItem("token"),a=await fetch(`http://157.245.142.215/api-scouts/public/api/user/delete/${e}`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}}),o=await a.json();return o}},i=s,u={all:async()=>{const e=localStorage.getItem("token"),l=await fetch("http://157.245.142.215/api-scouts/public/api/role",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),a=await l.json();return a}},r=u;var d=a(386),c=a(78),m=a(8825),p=a(2862);const g={class:"q-pa-md"},h=(0,o.Uk)("Crea un nuevo usuario"),b=(0,o.Uk)("Close"),w={class:"col-6 text-center"},_=(0,o.Uk)("Enviar"),v=(0,o.Uk)("Actualizar"),V={__name:"User",setup(e){const l=(0,p.U)(),a=(0,m.Z)(),s=(0,t.qj)({group_id:"",name:"",last_name:"",email:"",dni:"",date_born:"",phone:"",nacionality:"",gender:"",role:"",password:"",id:""}),u=(0,t.iH)(""),V=(0,t.iH)([]),f=(0,t.iH)([]),y=(0,t.iH)([]),W=(0,t.iH)([]),C=(0,t.iH)(!0),q=[{name:"name",label:"Nombre",field:e=>e.name,align:"center"},{name:"email",label:"Correo Electronico",field:e=>e.email,align:"center"},{name:"dni",label:"Cédula",field:e=>e.person.dni,align:"center"},{name:"rol",label:"Rol",field:e=>e.roles[0].nombre,align:"center"},{name:"age",label:"Edad",field:e=>{const l=new Date(e.person.born_date).getFullYear(),a=(new Date).getFullYear();return a-l},align:"center"},{name:"actions",label:"Actión",align:"center"}],k=(0,t.iH)(!1),U=[{name:"Hombre",id:1},{name:"Mujer",id:2}],Z=()=>{s.id="",s.name="",s.last_name="",s.dni="",s.nacionality="",s.gender="",s.email="",s.date_born="",s.role="",s.phone="",s.password="",s.group_id="",s.unit_id="",C.value=!0,k.value=!0},Q=()=>{if(a.loading.show(),""==s.name||""==s.last_name||""==s.dni||""==s.gender||""==s.date_born||""==s.email)return a.loading.hide(),a.dialog({title:"Alerta",message:"Completa los datos"}),0;i.create(s).then((e=>{e.success&&(a.dialog({title:"Información",message:"Se enviaron las credenciales al correo electrónico "}),T(),k.value=!1),console.log(e),a.loading.hide()}))},S=()=>{i.update(s).then((e=>{e.success&&(T(),k.value=!1),console.log(e)}))},T=()=>{i.all().then((e=>{console.log(e),V.value=e}))},j=e=>{console.log(e),s.id=e.id,s.name=e.person.name,s.last_name=e.person.last_name,s.dni=e.person.dni,s.nacionality=e.person.nacionality,s.gender=parseInt(e.person.gender),s.email=e.email,s.date_born=e.person.born_date,s.role=e.roles[0].id,s.phone=e.person.phone,C.value=!1,k.value=!0};r.all().then((e=>{const a=[];1==l.role?e.forEach((e=>{a.push(e)})):e.forEach((e=>{e.id>2&&a.push(e)})),f.value=a,console.log(e)})),d.Z.getGroups().then((e=>{console.log(e),y.value=e}));const A=()=>{c.Z.getUnitByGroup(s.group_id).then((e=>{W.value=e}))},E=e=>{a.dialog({title:"Advertencia",message:"¿Deseas eliminar este usuario?",cancel:!0}).onOk((async()=>{const l=await i["delete"](e.id);l.success&&T(),console.log(l)})).onCancel((()=>{}))};return(0,o.YP)((()=>s.group_id),A),T(),(e,l)=>{const a=(0,o.up)("q-btn"),t=(0,o.up)("q-icon"),i=(0,o.up)("q-input"),r=(0,o.up)("q-td"),d=(0,o.up)("q-table"),c=(0,o.up)("q-toolbar-title"),m=(0,o.up)("q-space"),p=(0,o.up)("q-tooltip"),T=(0,o.up)("q-bar"),A=(0,o.up)("q-date"),H=(0,o.up)("q-popup-proxy"),I=(0,o.up)("q-select"),B=(0,o.up)("q-form"),F=(0,o.up)("q-card-section"),x=(0,o.up)("q-card"),D=(0,o.up)("q-dialog"),$=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",g,[(0,o.Wm)(a,{label:"Crear usuario",color:"primary",class:"q-ma-md",onClick:Z}),(0,o.Wm)(d,{title:"Usuarios",columns:q,rows:V.value,filter:u.value},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(i,{borderless:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value=e),placeholder:"Search"},{append:(0,o.w5)((()=>[(0,o.Wm)(t,{name:"search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,o.w5)((e=>[(0,o.Wm)(r,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{color:"yellow",icon:"mode_edit",class:"q-mx-sm",onClick:l=>j(e.row)},null,8,["onClick"]),(0,o.Wm)(a,{color:"red",icon:"delete",onClick:l=>E(e.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["rows","filter"])]),(0,o.Wm)(D,{modelValue:k.value,"onUpdate:modelValue":l[13]||(l[13]=e=>k.value=e),"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{style:{width:"900px","max-width":"80vw"}},{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[h])),_:1}),(0,o.Wm)(m),(0,o.wy)(((0,o.wg)(),(0,o.j4)(a,{dense:"",flat:"",icon:"close"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"bg-white text-primary"},{default:(0,o.w5)((()=>[b])),_:1})])),_:1})),[[$]])])),_:1}),(0,o.Wm)(F,{class:"col q-pt-none q-mt-sm"},{default:(0,o.w5)((()=>[(0,o._)("div",w,[(0,o.Wm)(B,{class:"q-gutter-md row justify-center q-mt-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{modelValue:s.name,"onUpdate:modelValue":l[1]||(l[1]=e=>s.name=e),class:"col-sm-12 col-md-5",label:"Nombre",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío"]},null,8,["modelValue","rules"]),(0,o.Wm)(i,{modelValue:s.last_name,"onUpdate:modelValue":l[2]||(l[2]=e=>s.last_name=e),class:"col-sm-12 col-md-5",label:"Apellido",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío"]},null,8,["modelValue","rules"]),(0,o.Wm)(i,{modelValue:s.email,"onUpdate:modelValue":l[3]||(l[3]=e=>s.email=e),class:"col-sm-12 col-md-5",label:"Correo electrónico",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío"]},null,8,["modelValue","rules"]),(0,o.Wm)(i,{modelValue:s.dni,"onUpdate:modelValue":l[4]||(l[4]=e=>s.dni=e),class:"col-sm-12 col-md-5",label:"Dni",mask:"##########",rules:[e=>e&&10==e.length||"La cédula tiene 10 digitos"]},null,8,["modelValue","rules"]),(0,o.Wm)(i,{modelValue:s.date_born,"onUpdate:modelValue":l[6]||(l[6]=e=>s.date_born=e),class:"col-sm-12 col-md-5 cursor-pointer",label:"Fecha de Nacimiento",mask:"date"},{append:(0,o.w5)((()=>[(0,o.Wm)(t,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,null,{default:(0,o.w5)((()=>[(0,o.Wm)(A,{modelValue:s.date_born,"onUpdate:modelValue":l[5]||(l[5]=e=>s.date_born=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(i,{modelValue:s.phone,"onUpdate:modelValue":l[7]||(l[7]=e=>s.phone=e),class:"col-sm-12 col-md-5",label:"Teléfono",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío"]},null,8,["modelValue","rules"]),(0,o.Wm)(i,{modelValue:s.nacionality,"onUpdate:modelValue":l[8]||(l[8]=e=>s.nacionality=e),class:"col-sm-12 col-md-5",label:"Nacionalidad",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío"]},null,8,["modelValue","rules"]),(0,o.Wm)(I,{modelValue:s.gender,"onUpdate:modelValue":l[9]||(l[9]=e=>s.gender=e),"option-label":"name",options:U,"emit-value":"","map-options":"","option-value":"id",class:"col-sm-12 col-md-5",label:"Género"},null,8,["modelValue"]),(0,o.Wm)(I,{modelValue:s.role,"onUpdate:modelValue":l[10]||(l[10]=e=>s.role=e),class:"col-sm-12 col-md-5",options:f.value,label:"Selecciona un rol","option-label":"nombre","emit-value":"","map-options":"","option-value":"id"},null,8,["modelValue","options"]),(0,o.wy)((0,o.Wm)(I,{modelValue:s.group_id,"onUpdate:modelValue":l[11]||(l[11]=e=>s.group_id=e),class:"col-sm-12 col-md-5",options:y.value,label:"Selecciona un grupo","option-label":"name","emit-value":"","map-options":"","option-value":"id"},null,8,["modelValue","options"]),[[n.F8,4==s.role||5==s.role]]),(0,o.wy)((0,o.Wm)(I,{modelValue:s.unit_id,"onUpdate:modelValue":l[12]||(l[12]=e=>s.unit_id=e),class:"col-sm-12 col-md-5",options:W.value,label:"Selecciona una unidad","option-label":"name","emit-value":"","map-options":"","option-value":"id"},null,8,["modelValue","options"]),[[n.F8,""!=s.group_id]]),(0,o.wy)((0,o.Wm)(a,{class:"col-md-10",color:"amber",onClick:Q},{default:(0,o.w5)((()=>[_])),_:1},512),[[n.F8,C.value]]),(0,o.wy)((0,o.Wm)(a,{class:"col-md-10",color:"amber",onClick:S},{default:(0,o.w5)((()=>[v])),_:1},512),[[n.F8,!C.value]])])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var f=a(8240),y=a(3243),W=a(4842),C=a(4554),q=a(3884),k=a(6778),U=a(151),Z=a(846),Q=a(3747),S=a(2025),T=a(8870),j=a(5589),A=a(5269),E=a(3944),H=a(6915),I=a(8516),B=a(677),F=a(7518),x=a.n(F);const D=V,$=D;x()(V,"components",{QBtn:f.Z,QTable:y.Z,QInput:W.Z,QIcon:C.Z,QTd:q.Z,QDialog:k.Z,QCard:U.Z,QBar:Z.Z,QToolbarTitle:Q.Z,QSpace:S.Z,QTooltip:T.Z,QCardSection:j.Z,QForm:A.Z,QPopupProxy:E.Z,QDate:H.Z,QSelect:I.Z}),x()(V,"directives",{ClosePopup:B.Z})}}]);